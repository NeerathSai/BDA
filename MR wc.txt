

mapper.py

#!/usr/bin/python
import sys

#Word Count Example
# input comes from standard input STDIN
for line in sys.stdin:
        line = line.strip() #remove leading and trailing whitespaces
        words = line.split() #split the line into words and returns as a list
        for word in words:
                #write the results to standard output STDOUT
                print('%s    %s' % (word,1)) #Emit the word



reducer.py

#!/usr/bin/python
import sys

# using a dictionary to map words to their counts
current_word = None
current_count = 0
word = None
# input comes from STDIN
for line in sys.stdin:
        line = line.strip()
        word, count = line.split(' ',1)
        try:
                count = int(count)
        except ValueError:
                continue
        if current_word == word:
                current_count += count
        else:
                if current_word:
                        print('%s   %s' % (current_word, current_count))
                current_count = count
                current_word = word
if current_word == word:
        print('%s   %s' % (current_word,current_count))
